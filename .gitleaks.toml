# Gitleaks configuration for Murder Tech
# Detects secrets, API keys, and credentials before they get committed

title = "Murder Tech Secret Scanning"

[extend]
useDefault = true

[allowlist]
description = "Allowlist for known false positives"
regexes = [
  # Placeholder values
  '''PLACEHOLDER''',
  '''YOUR_.*_HERE''',
  '''example\.com''',
  '''localhost''',
  '''127\.0\.0\.1''',
]

paths = [
  # Ignore documentation
  '''.gitleaksignore''',
  '''kit's docs/.*\.md$''',
  # Ignore test files
  '''.*\.test\.(ts|js)$''',
  '''.*\.spec\.(ts|js)$''',
]

[[rules]]
description = "AWS Access Key"
id = "aws-access-key"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["key", "AWS"]

[[rules]]
description = "AWS Secret Key"
id = "aws-secret-key"
regex = '''(?i)aws(.{0,20})?(?-i)['\"][0-9a-zA-Z\/+]{40}['\"]'''
tags = ["key", "AWS"]

[[rules]]
description = "Discord Bot Token"
id = "discord-bot-token"
regex = '''(?i)(discord|bot)(.{0,20})?['\"][MN][A-Za-z0-9_-]{23,25}\.[A-Za-z0-9_-]{6}\.[A-Za-z0-9_-]{27,39}['\"]'''
tags = ["key", "Discord"]

[[rules]]
description = "Google API Key"
id = "google-api-key"
regex = '''AIza[0-9A-Za-z-_]{35}'''
tags = ["key", "Google"]

[[rules]]
description = "Generic API Key"
id = "generic-api-key"
regex = '''(?i)(api[_-]?key|apikey)(.{0,20})?['\"][0-9a-zA-Z]{32,45}['\"]'''
tags = ["key", "API"]

[[rules]]
description = "Generic Secret"
id = "generic-secret"
regex = '''(?i)(secret|password|passwd|pwd)(.{0,20})?['\"][0-9a-zA-Z]{12,}['\"]'''
tags = ["secret"]

[[rules]]
description = "Private Key"
id = "private-key"
regex = '''-----BEGIN (RSA |EC |OPENSSH )?PRIVATE KEY-----'''
tags = ["key", "private"]

[[rules]]
description = "Database Connection String"
id = "database-url"
regex = '''(?i)(postgres|postgresql|mysql|mongodb)://[^\s]+'''
tags = ["database"]

[[rules]]
description = "High Entropy String (potential secret)"
id = "high-entropy-string"
regex = '''['\"][0-9a-zA-Z+/]{40,}['\"]'''
entropy = 4.5
tags = ["entropy"]
